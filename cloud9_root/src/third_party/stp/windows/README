This patch to revision 446 was provided by Hume and tested under cygwin/mingw/centos 5.4/msvc9.0.

